---
layout: post
title: "ìš°ë¶„íˆ¬ ë¶€íŒ… ì†ë„ ìµœì í™”"
parent_category: study
category: programming
---

# systemd-analyze ë° ë¶€íŒ… ìµœì í™” ëª…ë ¹ì–´ ë ˆí¼ëŸ°ìŠ¤

## ğŸ“Š systemd-analyze ëª…ë ¹ì–´

### 1. ê¸°ë³¸ ë¶€íŒ… ì‹œê°„ ë¶„ì„
```bash
# ì „ì²´ ë¶€íŒ… ì‹œê°„ í™•ì¸
systemd-analyze

# ì¶œë ¥ ì˜ˆì‹œ:
# Startup finished in 18.075s (firmware) + 14.225s (loader) + 3.195s (kernel) + 59.227s (userspace) = 1min 34.723s
```
- **firmware**: UEFI/BIOS ì´ˆê¸°í™” ì‹œê°„
- **loader**: ë¶€íŠ¸ë¡œë”(GRUB) ì‹œê°„
- **kernel**: ì»¤ë„ ë¡œë”© ì‹œê°„
- **userspace**: systemd ë° ì„œë¹„ìŠ¤ ì‹œì‘ ì‹œê°„

### 2. ì„œë¹„ìŠ¤ë³„ ì‹œì‘ ì‹œê°„ (ëŠë¦° ìˆœ)
```bash
# ëª¨ë“  ì„œë¹„ìŠ¤ì˜ ì‹œì‘ ì‹œê°„ í‘œì‹œ
systemd-analyze blame

# ìƒìœ„ 20ê°œë§Œ ë³´ê¸°
systemd-analyze blame | head -20

# íŠ¹ì • ì„œë¹„ìŠ¤ ê²€ìƒ‰
systemd-analyze blame | grep postgresql
```

### 3. í¬ë¦¬í‹°ì»¬ ì²´ì¸ ë¶„ì„
```bash
# ë¶€íŒ… ë³‘ëª© ì§€ì  ì°¾ê¸° (ì˜ì¡´ì„± ì²´ì¸)
systemd-analyze critical-chain

# íŠ¹ì • ì„œë¹„ìŠ¤ì˜ í¬ë¦¬í‹°ì»¬ ì²´ì¸
systemd-analyze critical-chain NetworkManager.service
```

### 4. ë¶€íŒ… íƒ€ì„ë¼ì¸ ì‹œê°í™”
```bash
# SVG ê·¸ë˜í”„ë¡œ ë¶€íŒ… í”„ë¡œì„¸ìŠ¤ ì‹œê°í™”
systemd-analyze plot > boot_timeline.svg

# ë¸Œë¼ìš°ì €ì—ì„œ ì—´ê¸°
xdg-open boot_timeline.svg
```

### 5. ì„œë¹„ìŠ¤ ê²€ì¦
```bash
# ì„œë¹„ìŠ¤ ì„¤ì • íŒŒì¼ ê²€ì¦
systemd-analyze verify NetworkManager.service

# ëª¨ë“  ìœ ë‹› íŒŒì¼ ê²€ì¦
systemd-analyze verify
```

### 6. ë³´ì•ˆ ë¶„ì„
```bash
# ì„œë¹„ìŠ¤ ë³´ì•ˆ ì ìˆ˜ í™•ì¸
systemd-analyze security

# íŠ¹ì • ì„œë¹„ìŠ¤ ë³´ì•ˆ ë¶„ì„
systemd-analyze security postgresql@16-main.service
```

### 7. ì„¤ì • íŒŒì¼ í™•ì¸
```bash
# ì‹¤ì œ ì ìš©ë˜ëŠ” ì„¤ì • í™•ì¸ (ë³‘í•©ëœ ê²°ê³¼)
systemd-analyze cat-config systemd/journald.conf
```

---

## ğŸ”§ systemctl ì„œë¹„ìŠ¤ ê´€ë¦¬ ëª…ë ¹ì–´

### ì„œë¹„ìŠ¤ í™œì„±í™”/ë¹„í™œì„±í™”
```bash
# ì„œë¹„ìŠ¤ ë¹„í™œì„±í™” (ë¶€íŒ… ì‹œ ìë™ ì‹œì‘ ì•ˆ í•¨)
sudo systemctl disable [ì„œë¹„ìŠ¤ëª…]

# ì„œë¹„ìŠ¤ í™œì„±í™” (ë¶€íŒ… ì‹œ ìë™ ì‹œì‘)
sudo systemctl enable [ì„œë¹„ìŠ¤ëª…]

# ì„œë¹„ìŠ¤ ë§ˆìŠ¤í¬ (ì™„ì „íˆ ì°¨ë‹¨, ìˆ˜ë™ ì‹œì‘ë„ ë¶ˆê°€)
sudo systemctl mask [ì„œë¹„ìŠ¤ëª…]

# ë§ˆìŠ¤í¬ í•´ì œ
sudo systemctl unmask [ì„œë¹„ìŠ¤ëª…]
```

### ì„œë¹„ìŠ¤ ì‹œì‘/ì¤‘ì§€
```bash
# ì„œë¹„ìŠ¤ ì¦‰ì‹œ ì‹œì‘
sudo systemctl start [ì„œë¹„ìŠ¤ëª…]

# ì„œë¹„ìŠ¤ ì¤‘ì§€
sudo systemctl stop [ì„œë¹„ìŠ¤ëª…]

# ì„œë¹„ìŠ¤ ì¬ì‹œì‘
sudo systemctl restart [ì„œë¹„ìŠ¤ëª…]

# ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
systemctl status [ì„œë¹„ìŠ¤ëª…]
```

### ì„œë¹„ìŠ¤ ìƒíƒœ ì¡°íšŒ
```bash
# ì„œë¹„ìŠ¤ê°€ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
systemctl is-enabled [ì„œë¹„ìŠ¤ëª…]

# ì„œë¹„ìŠ¤ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
systemctl is-active [ì„œë¹„ìŠ¤ëª…]

# ëª¨ë“  ì‹¤í–‰ ì¤‘ì¸ ì„œë¹„ìŠ¤ ëª©ë¡
systemctl list-units --type=service --state=running

# í™œì„±í™”ëœ ëª¨ë“  ì„œë¹„ìŠ¤ ëª©ë¡
systemctl list-unit-files --type=service --state=enabled
```

---

## ğŸ“ journalctl ì €ë„ ë¡œê·¸ ê´€ë¦¬

### ë¡œê·¸ ì¡°íšŒ
```bash
# ì „ì²´ ë¡œê·¸ ë³´ê¸°
journalctl

# ìµœê·¼ ë¡œê·¸ë§Œ ë³´ê¸°
journalctl -n 50        # ìµœê·¼ 50ì¤„
journalctl --since today
journalctl --since "1 hour ago"

# íŠ¹ì • ì„œë¹„ìŠ¤ ë¡œê·¸
journalctl -u NetworkManager.service

# ì‹¤ì‹œê°„ ë¡œê·¸ ì¶”ì  (tail -fì™€ ìœ ì‚¬)
journalctl -f

# ë¶€íŒ…ë³„ ë¡œê·¸
journalctl --list-boots  # ë¶€íŒ… ëª©ë¡
journalctl -b 0          # í˜„ì¬ ë¶€íŒ…
journalctl -b -1         # ì´ì „ ë¶€íŒ…
```

### ë¡œê·¸ ì •ë¦¬
```bash
# ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ í™•ì¸
journalctl --disk-usage

# í¬ê¸° ê¸°ì¤€ìœ¼ë¡œ ì •ë¦¬
sudo journalctl --vacuum-size=100M

# ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ì •ë¦¬
sudo journalctl --vacuum-time=1week
sudo journalctl --vacuum-time=30d

# íŒŒì¼ ê°œìˆ˜ ê¸°ì¤€ìœ¼ë¡œ ì •ë¦¬
sudo journalctl --vacuum-files=5

# ëª¨ë“  ë¡œê·¸ ì‚­ì œ (ì£¼ì˜!)
sudo journalctl --rotate
sudo journalctl --vacuum-time=1s
```

### ë¡œê·¸ ê²€ìƒ‰
```bash
# ì—ëŸ¬ ë©”ì‹œì§€ë§Œ ë³´ê¸°
journalctl -p err

# ìš°ì„ ìˆœìœ„ ë ˆë²¨:
# 0: emerg   - ì‹œìŠ¤í…œ ì‚¬ìš© ë¶ˆê°€
# 1: alert   - ì¦‰ì‹œ ì¡°ì¹˜ í•„ìš”
# 2: crit    - ì‹¬ê°í•œ ìƒí™©
# 3: err     - ì—ëŸ¬
# 4: warning - ê²½ê³ 
# 5: notice  - ì •ìƒì´ì§€ë§Œ ì¤‘ìš”
# 6: info    - ì •ë³´
# 7: debug   - ë””ë²„ê·¸

# íŠ¹ì • ë¬¸ìì—´ ê²€ìƒ‰
journalctl | grep "error"

# ì»¤ë„ ë©”ì‹œì§€ë§Œ
journalctl -k
```

---

## âš™ï¸ journald.conf ì„¤ì • íŒŒì¼

### ì„¤ì • íŒŒì¼ ìœ„ì¹˜
```bash
# ë©”ì¸ ì„¤ì • íŒŒì¼
/etc/systemd/journald.conf

# ë“œë¡­ì¸ ì„¤ì • (ê¶Œì¥)
/etc/systemd/journald.conf.d/*.conf
```

### ì£¼ìš” ì„¤ì • ì˜µì…˜

#### ì €ì¥ ê´€ë ¨
```ini
[Journal]
# ì €ì¥ ìœ„ì¹˜
Storage=persistent    # /var/log/journalì— ì˜êµ¬ ì €ì¥
Storage=volatile      # /run/log/journalì— ì„ì‹œ ì €ì¥ (ì¬ë¶€íŒ… ì‹œ ì‚­ì œ)
Storage=auto          # ìë™ (persistent ìš°ì„ )

# ì••ì¶•
Compress=yes          # ì••ì¶• í™œì„±í™” (ê¶Œì¥)
```

#### í¬ê¸° ì œí•œ
```ini
# ì‹œìŠ¤í…œ ì „ì²´ ë¡œê·¸ ìµœëŒ€ í¬ê¸°
SystemMaxUse=100M     # 100MBë¡œ ì œí•œ

# ê°œë³„ ë¡œê·¸ íŒŒì¼ í¬ê¸°
SystemMaxFileSize=10M # íŒŒì¼ë‹¹ 10MB

# íŒŒì¼ ê°œìˆ˜ ì œí•œ
SystemMaxFiles=10     # ìµœëŒ€ 10ê°œ íŒŒì¼
```

#### ë³´ê´€ ê¸°ê°„
```ini
# ìµœëŒ€ ë³´ê´€ ì‹œê°„
MaxRetentionSec=1week   # 1ì£¼ì¼
MaxRetentionSec=1month  # 1ê°œì›”
MaxRetentionSec=1year   # 1ë…„

# ê°œë³„ íŒŒì¼ ë³´ê´€ ê¸°ê°„
MaxFileSec=1day       # í•˜ë£¨ë§ˆë‹¤ ìƒˆ íŒŒì¼ ìƒì„±
```

#### ì„±ëŠ¥ ê´€ë ¨
```ini
# ë™ê¸°í™” ê°„ê²© (ë””ìŠ¤í¬ ì“°ê¸°)
SyncIntervalSec=5m    # 5ë¶„ë§ˆë‹¤ ë™ê¸°í™” (ê¸°ë³¸ê°’)
SyncIntervalSec=1m    # 1ë¶„ (ë” ì•ˆì „í•˜ì§€ë§Œ ëŠë¦¼)

# Rate limiting (ë¡œê·¸ í­ì£¼ ë°©ì§€)
RateLimitIntervalSec=30s
RateLimitBurst=10000
```

### ì„¤ì • ì ìš© ë°©ë²•
```bash
# 1. ì„¤ì • íŒŒì¼ í¸ì§‘
sudo nano /etc/systemd/journald.conf

# 2. ì €ë„ ì„œë¹„ìŠ¤ ì¬ì‹œì‘
sudo systemctl restart systemd-journald

# 3. ì„¤ì • í™•ì¸
systemd-analyze cat-config systemd/journald.conf
```

---

## ğŸš€ ë¶€íŒ… ìµœì í™” ì²´í¬ë¦¬ìŠ¤íŠ¸

### 1ë‹¨ê³„: ë¶„ì„
```bash
# í˜„ì¬ ë¶€íŒ… ì‹œê°„ í™•ì¸
systemd-analyze

# ëŠë¦° ì„œë¹„ìŠ¤ ì°¾ê¸°
systemd-analyze blame | head -20

# ë³‘ëª© ì§€ì  í™•ì¸
systemd-analyze critical-chain
```

### 2ë‹¨ê³„: ë¶ˆí•„ìš”í•œ ì„œë¹„ìŠ¤ ë¹„í™œì„±í™”
```bash
# ë„¤íŠ¸ì›Œí¬ ëŒ€ê¸° ì„œë¹„ìŠ¤ (ë°ìŠ¤í¬í†±ì—ì„œ ë¶ˆí•„ìš”)
sudo systemctl disable NetworkManager-wait-online.service

# íŒŒì¼ì‹œìŠ¤í…œ ê²€ì‚¬ (ì¼ë°˜ì ìœ¼ë¡œ ë¶ˆí•„ìš”)
sudo systemctl disable e2scrub_reap.service
sudo systemctl disable e2scrub_all.timer

# ë¶€íŒ… ìŠ¤í”Œë˜ì‹œ í™”ë©´
sudo systemctl disable plymouth.service
sudo systemctl mask plymouth-quit-wait.service

# ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë°ì´í„°ë² ì´ìŠ¤
sudo systemctl disable postgresql@16-main.service
sudo systemctl disable mysql.service
```

### 3ë‹¨ê³„: ì €ë„ ìµœì í™”
```bash
# ì €ë„ í¬ê¸° ì œí•œ ì„¤ì •
sudo nano /etc/systemd/journald.conf
# SystemMaxUse=100M
# MaxRetentionSec=1week

# ì €ë„ ì¬ì‹œì‘
sudo systemctl restart systemd-journald

# ì˜¤ë˜ëœ ë¡œê·¸ ì •ë¦¬
sudo journalctl --vacuum-time=1week
```

### 4ë‹¨ê³„: ì¬ë¶€íŒ… ë° í™•ì¸
```bash
# ì¬ë¶€íŒ…
sudo reboot

# ì¬ë¶€íŒ… í›„ í™•ì¸
systemd-analyze
systemd-analyze blame | head -20
```

---

## ğŸ“‹ ìì£¼ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì–´ ì¡°í•©

### ë¶€íŒ… ì‹œê°„ ì „í›„ ë¹„êµ
```bash
# ìµœì í™” ì „
systemd-analyze > boot_before.txt
systemd-analyze blame > blame_before.txt

# ìµœì í™” í›„ (ì¬ë¶€íŒ… í›„)
systemd-analyze > boot_after.txt
systemd-analyze blame > blame_after.txt

# ë¹„êµ
diff boot_before.txt boot_after.txt
```

### íŠ¹ì • ì„œë¹„ìŠ¤ ì™„ì „ ë¹„í™œì„±í™”
```bash
# 1. ì¤‘ì§€
sudo systemctl stop [ì„œë¹„ìŠ¤ëª…]

# 2. ë¹„í™œì„±í™”
sudo systemctl disable [ì„œë¹„ìŠ¤ëª…]

# 3. ë§ˆìŠ¤í¬ (ì„ íƒì‚¬í•­, ì™„ì „ ì°¨ë‹¨)
sudo systemctl mask [ì„œë¹„ìŠ¤ëª…]

# 4. í™•ì¸
systemctl status [ì„œë¹„ìŠ¤ëª…]
```

### PostgreSQL ìˆ˜ë™ ê´€ë¦¬
```bash
# í•„ìš”í•  ë•Œë§Œ ì‹œì‘
sudo systemctl start postgresql@16-main.service

# ì‚¬ìš© í›„ ì¤‘ì§€
sudo systemctl stop postgresql@16-main.service

# ìƒíƒœ í™•ì¸
systemctl status postgresql@16-main.service
```

---

## ğŸ”„ ì›ìƒë³µêµ¬ ë°©ë²•

### ì„œë¹„ìŠ¤ ë‹¤ì‹œ í™œì„±í™”
```bash
# ë¹„í™œì„±í™”í•œ ì„œë¹„ìŠ¤ ë‹¤ì‹œ í™œì„±í™”
sudo systemctl enable [ì„œë¹„ìŠ¤ëª…]

# ë§ˆìŠ¤í¬ í•´ì œ
sudo systemctl unmask [ì„œë¹„ìŠ¤ëª…]

# ì¦‰ì‹œ ì‹œì‘
sudo systemctl start [ì„œë¹„ìŠ¤ëª…]
```

### ì €ë„ ì„¤ì • ì›ë³µ
```bash
# ë°±ì—… íŒŒì¼ì´ ìˆë‹¤ë©´
sudo cp /etc/systemd/journald.conf.backup /etc/systemd/journald.conf

# ë˜ëŠ” ê¸°ë³¸ê°’ìœ¼ë¡œ (ëª¨ë‘ ì£¼ì„ ì²˜ë¦¬)
sudo nano /etc/systemd/journald.conf
# [Journal] ì„¹ì…˜ì˜ ëª¨ë“  ì„¤ì •ì„ # ìœ¼ë¡œ ì£¼ì„ ì²˜ë¦¬

# ì¬ì‹œì‘
sudo systemctl restart systemd-journald
```

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **ì„œë¹„ìŠ¤ ë¹„í™œì„±í™” ì „ í™•ì¸**
   - í•´ë‹¹ ì„œë¹„ìŠ¤ê°€ ë¬´ì—‡ì„ í•˜ëŠ”ì§€ í™•ì¸
   - ì˜ì¡´í•˜ëŠ” ë‹¤ë¥¸ ì„œë¹„ìŠ¤ê°€ ìˆëŠ”ì§€ í™•ì¸
   ```bash
   systemctl list-dependencies [ì„œë¹„ìŠ¤ëª…]
   ```

2. **ë°±ì—…**
   - ì„¤ì • ë³€ê²½ ì „ í•­ìƒ ë°±ì—…
   ```bash
   sudo cp /etc/systemd/journald.conf /etc/systemd/journald.conf.backup
   ```

3. **ì¬ë¶€íŒ… í•„ìˆ˜**
   - ëŒ€ë¶€ë¶„ì˜ ë¶€íŒ… ìµœì í™”ëŠ” ì¬ë¶€íŒ… í›„ ì ìš©ë¨
   - ì¬ë¶€íŒ… ì „ì—ëŠ” íš¨ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŒ

4. **ì„œë²„ í™˜ê²½ ì£¼ì˜**
   - ì„œë²„ í™˜ê²½ì—ì„œëŠ” NetworkManager-wait-online ë“±ì´ í•„ìš”í•  ìˆ˜ ìˆìŒ
   - ë°ìŠ¤í¬í†± í™˜ê²½ì—ì„œë§Œ ì•ˆì „í•˜ê²Œ ë¹„í™œì„±í™”