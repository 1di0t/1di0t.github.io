---
layout: post
title: "우분투 저널 정리를 통한 부팅 시간 단축"
parent_category: study
category: programming
---

명령어로 저널 설정하기 (파일 위치 몰라도 됨)
방법 1: 한 줄 명령어로 설정 파일 자동 생성
저는 옵션 B (100MB, 1주일) 설정으로 예시를 들겠습니다.
설정 파일 자동 생성 명령어:
# 디렉토리 생성 + 설정 파일 생성을 한 번에
sudo mkdir -p /etc/systemd/journald.conf.d/ && sudo tee /etc/systemd/journald.conf.d/00-journal-size.conf > /dev/null <<EOF
[Journal]
# 저널 최대 크기를 100MB로 제한
SystemMaxUse=100M

# 1주일 이상 된 로그는 자동 삭제
MaxRetentionSec=1week

# 개별 저널 파일 크기 10MB로 설정
SystemMaxFileSize=10M

# 시스템에 최소 500MB 여유 공간 확보
SystemKeepFree=500M
EOF
이 명령어는:
/etc/systemd/journald.conf.d/ 디렉토리를 만들고
00-journal-size.conf 파일을 생성하고
설정 내용을 자동으로 작성합니다
파일 위치를 몰라도 됩니다!
방법 2: 다른 옵션들
옵션 A: 보수적 (200MB, 2주일)
sudo mkdir -p /etc/systemd/journald.conf.d/ && sudo tee /etc/systemd/journald.conf.d/00-journal-size.conf > /dev/null <<EOF
[Journal]
SystemMaxUse=200M
MaxRetentionSec=2week
SystemKeepFree=500M
EOF
옵션 C: 공격적 (50MB, 3일)
sudo mkdir -p /etc/systemd/journald.conf.d/ && sudo tee /etc/systemd/journald.conf.d/00-journal-size.conf > /dev/null <<EOF
[Journal]
SystemMaxUse=50M
MaxRetentionSec=3day
SystemMaxFileSize=8M
SystemKeepFree=500M
EOF
방법 3: 설정 확인 명령어
설정 파일이 잘 만들어졌는지 확인:
# 생성된 파일 내용 보기
cat /etc/systemd/journald.conf.d/00-journal-size.conf
또는
# 적용될 전체 설정 보기 (기본값 + 커스텀 설정 합친 것)
systemd-analyze cat-config systemd/journald.conf
전체 적용 과정 (복사-붙여넣기용)
🎯 추천: 옵션 B (100MB, 1주일) 완전 자동화
다음 명령어들을 순서대로 하나씩 복사해서 터미널에 붙여넣으세요:
# 1단계: 설정 파일 생성
sudo mkdir -p /etc/systemd/journald.conf.d/ && sudo tee /etc/systemd/journald.conf.d/00-journal-size.conf > /dev/null <<'EOF'
[Journal]
SystemMaxUse=100M
MaxRetentionSec=1week
SystemMaxFileSize=10M
SystemKeepFree=500M
EOF
# 2단계: 설정 파일 확인
cat /etc/systemd/journald.conf.d/00-journal-size.conf
# 3단계: 현재 저널 크기 확인 (변경 전)
journalctl --disk-usage
# 4단계: journald 재시작 (설정 적용)
sudo systemctl restart systemd-journald
# 5단계: 기존 대용량 로그 즉시 정리
sudo journalctl --vacuum-size=100M
# 6단계: 정리 후 저널 크기 확인
journalctl --disk-usage
# 7단계: 다음 부팅에서 효과 확인용
echo "설정 완료! 다음 부팅 시 'systemd-analyze blame' 명령어로 부팅 시간을 확인하세요."
설정 되돌리기 (명령어 한 줄)
만약 설정을 원래대로 되돌리고 싶다면:
# 설정 파일 삭제 + journald 재시작
sudo rm -f /etc/systemd/journald.conf.d/00-journal-size.conf && sudo systemctl restart systemd-journald
예상 결과
변경 전:
$ journalctl --disk-usage
Archived and active journals take up 538.2M in the file system.
변경 후:
$ journalctl --disk-usage
Archived and active journals take up 96.0M in the file system.
다음 부팅 시:
$ systemd-analyze
Startup finished in 18.174s (firmware) + 9.215s (loader) + 3.227s (kernel) + 30s (userspace) = 1min
(기존 1분 37초 → 약 1분으로 단축)
추가 유용한 명령어
저널 상태 한눈에 보기
# 현재 저널 설정 확인
journalctl --header

# 저널 크기
journalctl --disk-usage

# 저널이 정상인지 확인
sudo journalctl --verify
특정 부팅 로그만 정리
# 현재 부팅 제외하고 이전 부팅 로그만 삭제
sudo journalctl --vacuum-time=0
로그 즉시 확인
# 최근 에러 로그 10줄
journalctl -p err -n 10

# 현재 부팅 로그
journalctl -b

# 실시간 로그 모니터링
journalctl -f
파일 위치를 찾는 명령어 (참고용)
나중에 설정 파일 위치를 잊어버렸다면:
# journald 관련 모든 설정 파일 찾기
find /etc -name "*journald*" 2>/dev/null
또는
# 적용된 설정 전체 보기 (어디에 있는지도 표시됨)
systemd-analyze cat-config systemd/journald.conf
요약: 가장 쉬운 방법
3단계만 기억하세요: 1️⃣ 설정 파일 생성 (위의 복사-붙여넣기 명령어)
sudo mkdir -p /etc/systemd/journald.conf.d/ && sudo tee /etc/systemd/journald.conf.d/00-journal-size.conf > /dev/null <<'EOF'
[Journal]
SystemMaxUse=100M
MaxRetentionSec=1week
EOF
2️⃣ 적용
sudo systemctl restart systemd-journald
3️⃣ 기존 로그 정리
sudo journalctl --vacuum-size=100M